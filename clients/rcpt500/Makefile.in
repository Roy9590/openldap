PROGRAMS= rcpt500
SRCS= main.c cmds.c help.c query.c
XSRCS= version.c
OBJS= main.o cmds.o help.o query.o
HDRS= rcpt500.h

LDAP_INCDIR= ../../include       
LDAP_LIBDIR= ../../libraries

XLIBS =  -lldap -llber -llutil
XXLIBS	= $(KRB_LIBS) $(LUTIL_LIBS)

rcpt500 : version.o
	$(LTLINK) -o $@ version.o $(OBJS) $(LIBS)

version.c: ${OBJS} $(LDAP_LIBDEPEND)
	$(RM) $@
	(u=$${USER-root} v=`$(CAT) $(VERSIONFILE)` d=`$(PWD)` h=`$(HOSTNAME)` \
	    t=`$(DATE)`; $(SED) -e "s|%WHEN%|$${t}|" \
	    -e "s|%WHOANDWHERE%|$${u}@$${h}:$${d}|" \
	    -e "s|%VERSION%|$${v}|" \
	    < $(srcdir)/Version.c > $@)

install-local: $(PROGRAMS) rcpt500.help FORCE
	-$(MKDIR) $(libexecdir) $(datadir)
	$(LTINSTALL) $(INSTALLFLAGS) -m 755 rcpt500 $(libexecdir)
	-$(MV) $(datadir)/rcpt500.help $(datadir)/rcpt500.help-
	$(INSTALL) $(INSTALLFLAGS) -m 644 $(srcdir)/rcpt500.help $(datadir)
