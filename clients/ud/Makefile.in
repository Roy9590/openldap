SRCS=	main.c find.c mod.c print.c auth.c util.c help.c \
	string_to_key.c group.c edit.c globals.c
XSRCS= version.c
OBJS=	main.o find.o mod.o print.o auth.o util.o help.o \
	string_to_key.o group.o globals.o edit.o
HDRS=	ud.h
PROGRAMS= ud

LDAP_INCDIR= ../../include       
LDAP_LIBDIR= ../../libraries

XLIBS = $(TERMCAP_LIBS)

ud : version.o
	$(LTLINK) -o $@ version.o $(OBJS) $(LIBS)

version.c: ${OBJS} $(LDAP_LIBDEPEND)
	$(RM) $@
	(u=$${USER-root} v=`$(CAT) $(VERSIONFILE)` d=`$(PWD)` h=`$(HOSTNAME)` \
	    t=`$(DATE)`; $(SED) -e "s|%WHEN%|$${t}|" \
	    -e "s|%WHOANDWHERE%|$${u}@$${h}:$${d}|" \
	    -e "s|%VERSION%|$${v}|" \
	    < $(srcdir)/Version.c > $@)

install-local: FORCE
	-$(MKDIR) -p $(bindir)
	-mv -f $(bindir)/ud $(bindir)/ud-
	$(LTINSTALL) $(INSTALLFLAGS) -m 775 ud $(bindir)
