# $OpenLDAP$
##
## Makefile for LDAP tools
##
SRCS	= ldapsearch.c ldapmodify.c ldapdelete.c ldapmodrdn.c \
		ldappasswd.c ldapwhoami.c ldapcompare.c common.c
OBJS	= ldapsearch.o ldapmodify.o ldapdelete.o ldapmodrdn.o \
		ldappasswd.o ldapwhoami.o ldapcompare.o common.o

LDAP_INCDIR= ../../include       
LDAP_LIBDIR= ../../libraries

MKVOPTS = -s

XLIBS =  $(LDAP_LIBLDIF_A) $(LDAP_L)
XXLIBS	= $(SECURITY_LIBS) $(LDIF_LIBS) $(LUTIL_LIBS)

XSRCS	= ldsversion.c ldmversion.c lddversion.c ldrversion.c \
	ldpversion.c ldwversion.c ldcversion.c

PROGRAMS = ldapsearch ldapmodify ldapdelete ldapmodrdn \
	ldappasswd ldapwhoami ldapcompare


ldapsearch:	ldapsearch.o common.o $(XLIBS)
	$(LTLINK) -o $@ ldapsearch.o common.o $(LIBS)

ldapmodify:	ldapmodify.o common.o $(XLIBS)
	$(LTLINK) -o $@ ldapmodify.o common.o $(LIBS)

ldapdelete:	ldapdelete.o common.o $(XLIBS)
	$(LTLINK) -o $@ ldapdelete.o common.o $(LIBS)

ldapmodrdn:	ldapmodrdn.o common.o $(XLIBS)
	$(LTLINK) -o $@ ldapmodrdn.o common.o $(LIBS)

ldappasswd:	ldappasswd.o common.o $(XLIBS)
	$(LTLINK) -o $@ ldappasswd.o common.o $(LIBS)

ldapwhoami:	ldapwhoami.o common.o $(XLIBS)
	$(LTLINK) -o $@ ldapwhoami.o common.o $(LIBS)

ldapcompare: ldapcompare.o common.o $(XLIBS)
	$(LTLINK) -o $@ ldapcompare.o common.o $(LIBS)

ldapsearch.o:	$(srcdir)/ldapsearch.c
	$(CC) -c $(CFLAGS) $(CWD_DEF) -o $@ $<

ldapmodify.o:	$(srcdir)/ldapmodify.c
	$(CC) -c $(CFLAGS) $(CWD_DEF) -o $@ $<

ldapdelete.o:	$(srcdir)/ldapdelete.c
	$(CC) -c $(CFLAGS) $(CWD_DEF) -o $@ $<

ldapmodrdn.o:	$(srcdir)/ldapmodrdn.c
	$(CC) -c $(CFLAGS) $(CWD_DEF) -o $@ $<

ldappasswd.o:	$(srcdir)/ldappasswd.c
	$(CC) -c $(CFLAGS) $(CWD_DEF) -o $@ $<

ldapwhoami.o:	$(srcdir)/ldapwhoami.c
	$(CC) -c $(CFLAGS) $(CWD_DEF) -o $@ $<

ldapcompare.o:	$(srcdir)/ldapcompare.c
	$(CC) -c $(CFLAGS) $(CWD_DEF) -o $@ $<

install-local:	FORCE
	-$(MKDIR) $(DESTDIR)$(bindir)
	@(								\
	    for prg in $(PROGRAMS); do					\
		$(LTINSTALL) $(INSTALLFLAGS) -s -m 755 $$prg$(EXEEXT)	\
		    $(DESTDIR)$(bindir);				\
	    done							\
	)
	$(RM) $(DESTDIR)$(bindir)/ldapadd$(EXEEXT)
	$(LN) $(DESTDIR)$(bindir)/ldapmodify$(EXEEXT) $(DESTDIR)$(bindir)/ldapadd$(EXEEXT)

