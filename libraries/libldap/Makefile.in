##
## Makefile.in for LDAP -lldap
##
LIBRARY = libldap.la
PROGRAMS = apitest ltest ttest

SRCS	= bind.c open.c result.c error.c compare.c search.c \
	modify.c add.c modrdn.c delete.c abandon.c ufn.c cache.c \
	getfilter.c sbind.c kbind.c unbind.c friendly.c cldap.c \
	free.c disptmpl.c srchpref.c dsparse.c tmplout.c sort.c \
	getdn.c getentry.c getattr.c getvalues.c addentry.c \
	request.c getdxbyname.c os-ip.c url.c charset.c \
	init.c options.c strdup.c
OBJS	= bind.lo open.lo result.lo error.lo compare.lo search.lo \
	modify.lo add.lo modrdn.lo delete.lo abandon.lo ufn.lo cache.lo \
	getfilter.lo sbind.lo kbind.lo unbind.lo friendly.lo cldap.lo \
	free.lo disptmpl.lo srchpref.lo dsparse.lo tmplout.lo sort.lo \
	getdn.lo getentry.lo getattr.lo getvalues.lo addentry.lo \
	request.lo getdxbyname.lo os-ip.lo url.lo charset.lo \
	init.lo options.lo strdup.lo

LDAP_INCDIR= ../../include       
LDAP_LIBDIR= ../../libraries

LIBS = $(LDAP_LIBPATH) $(LDAP_LIBLDAP) $(LDAP_LIBLBER) $(AC_LIBS)

apitest:	$(LIBRARY) apitest.o $(LDAP_LIBLBER_DEPEND)
	$(LTLINK) $(LDFLAGS) -o $@ apitest.o $(LIBS)
ltest:	$(LIBRARY) test.o $(LDAP_LIBLBER_DEPEND)
	$(LTLINK) $(LDFLAGS) -o $@ test.o $(LIBS)
ttest:	$(LIBRARY) tmpltest.o $(LDAP_LIBLBER_DEPEND)
	$(LTLINK) $(LDFLAGS) -o $@ tmpltest.o $(LIBS)

CFFILES= ldap.conf ldapfilter.conf ldapfriendly \
	ldaptemplates.conf ldapsearchprefs.conf

install-local: $(CFFILES) FORCE
	-$(MKDIR) -p $(libdir)
	$(LTINSTALL) $(INSTALLFLAGS) -m 644 $(LIBRARY) $(libdir)
	-$(MKDIR) -p $(sysconfdir)
	@for i in $(CFFILES); do \
		echo "installing $$i in $(sysconfdir)"; \
		if test -f $(sysconfdir)/$$i; then \
			$(MV) $(sysconfdir)/$$i $(sysconfdir)/$$i-; \
		fi; \
		$(INSTALL) $(INSTALLFLAGS) -m 644 $$i $(sysconfdir); \
	done

