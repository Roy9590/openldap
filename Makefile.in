# Master Makefile for OpenLDAP
##
## Copyright 1998,1999 The OpenLDAP Foundation, Redwood City, California, USA
## All rights reserved.
##
## Redistribution and use in source and binary forms are permitted only
## as authorized by the OpenLDAP Public License.  A copy of this
## license is available at http://www.OpenLDAP.org/license.html or
## in file LICENSE in the top-level directory of the distribution.
##

SUBDIRS= include libraries clients servers # contrib
CLEANDIRS= tests doc
INSTALLDIRS= doc

makefiles:	FORCE
	./config.status

${srcdir}/configure: configure.in aclocal.m4
	cd ${srcdir} && autoconf

# autoheader might not change portable.h.in, so touch a stamp file
${srcdir}/include/portable.h.in:	stamp-h.in
${srcdir}/stamp-h.in: configure.in aclocal.m4 acconfig.h \
	${srcdir}/include/portable.h.top ${srcdir}/include/portable.h.bot	
	cd ${srcdir} && autoheader
	@echo timestamp > ${srcdir}/stamp-h.in

./include/portable.h: stamp-h
stamp-h: config.h.in config.status
	./config.status

Makefile: Makefile.in config.status
	./config.status

config.status: configure
	./config.status --recheck


# force a make all before make install
#	only done at the top-level
install-common: all FORCE

clean-local: FORCE
	$(RM) config.log

veryclean-local: FORCE
	$(RM) config.cache config.status libtool stamp-h stamp-h.in

distclean: veryclean FORCE
